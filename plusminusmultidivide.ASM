	ORG	00H
START:	MOV	R4,#06H
	MOV	R0,#30H
CLR:	MOV	@R0,#00H
	INC	R0
	DJNZ	R4,CLR
L1:	MOV	R3,#F7H
	MOV	R1,#00H
L2:	MOV	A,R3
	MOV	P1,A
	MOV	A,P1	
	MOV	R4,A
	SETB	C
	MOV	R5,#04H
L3:	RLC	A
	JNC	KEYIN
	INC	R1
	DJNZ	R5,L3
	CALL	DISP
	MOV	A,R3	
	SETB	C
	RRC	A
	MOV	R3,A
	JC	L2
	JMP	L1
KEYIN:	MOV	R7,#60
D2:	MOV	R6,#248
	DJNZ	R6,$
	DJNZ	R7,D2
D3:	MOV	A,P1
	XRL	A,R4
	JZ	D3
	MOV	A,R1	
	MOV	DPTR,#TABLE
	MOVC	A,@A+DPTR
	MOV	14H,A
	MOV	A,14H
	XRL	A,#0DH
	JZ	STAGEF
	MOV	A,14H
	XRL	A,#0CH
	JZ	STAGER
	MOV	A,14H
	XRL	A,#0AH
	JZ	STAGE1
	MOV	A,14H
	XRL	A,#0BH
	JZ	STAGE1
	MOV	A,14H
	XRL	A,#0EH
	JZ	STAGE1
	MOV	A,14H
	XRL	A,#0FH
	JZ	STAGE1
	MOV	A,14H
	XCH	A,30H
	XCH	A,31H
	XCH	A,32H
	XCH	A,33H
	CALL	DISP
	JMP	L1
STAGER:	JMP	START
STAGE1:	MOV	20H,14H
	MOV	A,31H
	MOV	B,#10H
	MUL	AB
	ADD	A,30H
	MOV	11H,A
	MOV	A,33H
	MOV	B,#10H
	MUL	AB
	ADD	A,32H
	MOV	10H,A
	JMP	START
STAGEF:	MOV	A,31H
	MOV	B,#10H
	MUL	AB
	ADD	A,30H
	MOV	13H,A
	MOV	A,33H
	MOV	B,#10H
	MUL	AB
	ADD	A,32H
	MOV	12H,A
	MOV	A,20H
	CJNE	A,#0AH,MUSCON ; ADAING
	MOV	5BH,12H
	MOV	5CH,13H
	MOV	4BH,10H
	MOV	4CH,11H
	CALL	FUNADD
	MOV	A,4CH
	MOV	B,#10H
	DIV	AB
	MOV 	30H,B
	MOV	31H,A
	MOV	A,4BH
	MOV	B,#10H
	DIV	AB
	MOV	32H,B
	MOV	33H,A
	JMP	TQUANZ
MUSCON:	CJNE	A,#0BH,SISCON
	MOV	5BH,12H
	MOV	5CH,13H
	MOV	4BH,10H
	MOV	4CH,11H
	CALL	FUNSUB
	MOV	a,4CH
	MOV	B,#10H
	DIV	AB
	MOV 	30H,B
	MOV	31H,A
	MOV	a,4BH
	MOV	B,#10H
	DIV	AB
	MOV	32H,B
	MOV	33H,A
	JMP	TQUANZ
SISCON:	CJNE	A,#0EH,TONGLE
	CALL	TUIFEI
	JMP	TQUANZ
TONGLE:	CJNE	A,#0FH,TQUANZ
	CALL	DIVIS
TQUANZ:	CLR	C
	MOV	20H,#00H
	CALL	DISP
	JMP	L1
DISP:	MOV	P3,#00H  ;CLR GHOST EFFECT
	MOV	A,33H
	ADD	A,#10H
	MOV	DPTR,#TABLE
	MOVC	A,@A+DPTR
	MOV	P0,A
	MOV	P3,#08H
	CALL	DELAY
	MOV	P3,#00H  ;CLR GHOST EFFECT
	MOV	A,32H
	ADD	A,#10H
	MOV	DPTR,#TABLE
	MOVC	A,@A+DPTR
	MOV	P0,A
	MOV	P3,#04H
	CALL	DELAY
	MOV	P3,#00H  ;CLR GHOST EFFECT
	MOV	A,31H
	ADD	A,#10H
	MOV	DPTR,#TABLE
	MOVC	A,@A+DPTR
	MOV	P0,A
	MOV	P3,#02H
	CALL	DELAY
	MOV	P3,#00H  ;CLR GHOST EFFECT
	MOV	A,30H
	ADD	A,#10H
	MOV	DPTR,#TABLE
	MOVC	A,@A+DPTR
	MOV	P0,A
	MOV	P3,#01H
	CALL	DELAY
	RET
DELAY:	MOV	R7,#06
D1:	MOV	R6,#248
	DJNZ	R6,$
	DJNZ	R7,D1
	RET
DIVIS:	MOV	A,10H
	MOV	B,#10H
	DIV	AB
	MOV	21H,A
	MOV	22H,B
	MOV	A,11H
	MOV	B,#10H
	DIV	AB
	MOV	23H,A
	MOV	24H,B
	MOV	16H,#00H
	MOV	18H,12H
	MOV	19H,13H
	MOV	A,10H	;1 DIGIT
	MOV	B,#10H
	DIV	AB
	MOV	17H,A	;TO HERE
	CALL	BIJIAO
	XRL	16H,#01H
	JNZ	DIVI1
	MOV	17H,10H	;12 DIGIT
	CALL	BIJIAO
	XRL	16H,#01H
	JNZ	DIVI2
	MOV	A,10H	;1.. DIGIT
	MOV	B,#10H
	DIV	AB
	MOV	16H,A	;.23 DIGIT
	MOV	A,B	
	MOV	B,#10H
	MUL	AB
	MOV	17H,A
	MOV	A,11H
	MOV	B,#10H
	DIV	AB
	XCH	A,B
	MOV	A,17H
	ADD	A,B	
	MOV	17H,A	;HI
	CALL	BIJIAO
	XRL	16H,#01H
	JNZ	DIVI3
	MOV	16H,10H
	MOV	17H,11H
	CALL	BIJIAO
	XRL	16H,#01H
	JNZ	DIVI4
	MOV	16H,#00H
	MOV	17H,#00H
	MOV	18H,#00H
	MOV	19H,#00H
	MOV	30H,#00H
	MOV	31H,#00H
	MOV	32H,#00H
	MOV	33H,#00H
	JMP	YUSSS
DIVI1:	MOV	R0,#33H
	MOV	1BH,#00H
	MOV	1CH,21H
	JMP	DIVI1B
DIVI2:	MOV	R0,#32H
	MOV	33H,#00H
	MOV	1BH,#00H
	MOV	1CH,10H
	JMP	DIVI1B
DIVI3:	MOV	R0,#31H
	MOV	33H,#00H
	MOV	32H,#00H
	MOV	1BH,21H
	MOV	A,22H
	SWAP	A
	ADD	A,23H
	MOV	1CH,A
	JMP	DIVI1B
DIVI4:	MOV	R0,#30H
	MOV	33H,#00H
	MOV	32H,#00H
	MOV	31H,#00H
	MOV	1BH,10H
	MOV	1CH,11H
DIVI1B:	MOV	1AH,#00H
	MOV	16H,1BH
	MOV	17H,1CH
	MOV	18H,12H
	MOV	19H,13H
	XRL	A,#01H
	CALL	BIJIAO
	MOV	A,16H
	XRL	A,#01H
	JZ	FANSW
DIVI1A:	MOV	5BH,12H
	MOV	5CH,13H
	MOV	4BH,18H
	MOV	4CH,19H
	CALL	FUNADD
	MOV	18H,4BH
	MOV	19H,4CH
	MOV	16H,1BH
	MOV	17H,1CH
	INC	1AH
	CALL	BIJIAO
	MOV	A,16H
	XRL	A,#01H
	JZ	FANSW
	JNZ	DIVI1A
FANSW:	MOV	@R0,1AH
	MOV	4BH,18H
	MOV	4CH,19H
	MOV	5BH,12H
	MOV	5CH,13H
	CALL	FUNSUB
	MOV	16H,1BH	
	MOV	17H,1CH
	MOV	5BH,4BH
	MOV	5CH,4CH
	MOV	4BH,16H
	MOV	4CH,17H
	CALL	FUNSUB
	MOV	1BH,4BH
	MOV	1CH,4CH
	MOV	A,1BH
	SWAP	A
	ANL	A,#F0H
	MOV	1BH,A
	MOV	A,1CH
	MOV	B,#10H
	DIV	AB
	ADD	A,1BH
	MOV	1BH,A
	MOV	A,B
	SWAP	A
	MOV	1CH,A
	DEC	R0
	MOV	A,R0
	CJNE	A,#32H,NXTA
	MOV	A,1CH
	ADD	A,22H
	JMP	NXTD
NXTA:	CJNE	A,#31H,NXTB
	MOV	A,1CH
	ADD	A,23H
	JMP	NXTD
NXTB:	CJNE	A,#30H,NXTC
	MOV	A,1CH
	ADD	A,24H
NXTD:	MOV	1CH,A
	JMP	DIVI1B
NXTC:	CJNE	A,#2FH,NXTD
	JMP	YUSSS
YUSSS:	RET
TUIFEI:	MOV	A,11H
	MOV	B,#10H
	DIV	AB
	MOV	23H,A
	MOV	24H,B
	MOV	A,10H
	MOV	B,#10H
	DIV	AB
	MOV	22H,A
	MOV	21H,B
	MOV	26H,10H
	MOV	27H,11H
	MOV	28H,#00H
	MOV	29H,30H
	CALL	FUNMUL
	MOV	4BH,#00H
	MOV	4CH,#00H
	CALL	FUNADD
	MOV	2BH,4BH
	MOV	2CH,4CH
	MOV	A,10H
	ANL	A,#0FH
	SWAP	A
	ADD	A,23H
	MOV	26H,A
	MOV	A,24H
	SWAP	A
	MOV	27H,A
	MOV	28H,#00H
	MOV	29H,31H
	CALL	FUNMUL
	MOV	4BH,2BH
	MOV	4CH,2CH
	CALL	FUNADD
	MOV	2BH,4BH
	MOV	2CH,4CH
	MOV	26H,11H
	MOV	27H,#00H
	MOV	28H,#00H
	MOV	29H,32H
	CALL	FUNMUL
	MOV	4BH,2BH
	MOV	4CH,2CH
	CALL	FUNADD
	MOV	2BH,4BH
	MOV	2CH,4CH
	MOV	A,24H
	SWAP	A
	MOV	26H,A
	MOV	27H,#00H
	MOV	28H,#00H
	MOV	29H,33H
	CALL	FUNMUL
	MOV	4BH,2BH
	MOV	4CH,2CH
	CALL	FUNADD
	MOV	A,4BH		; < DAILY OUTPUT FROM HERE
	MOV	B,#10H		
	DIV	AB
	MOV	33H,A
	MOV	32H,B
	MOV	A,4CH
	MOV	B,#10H
	DIV	AB
	MOV	31H,A
	MOV	30H,B
	RET
FUNMUL:	MOV	1AH,#00H	
	MOV	1BH,#00H	
	MOV	1CH,#00H	
	MOV	1DH,#00H	
	MOV	1EH,#00H
	MOV	15H,#00H	
	MOV	16H,#00H	;FOR ZERO SIMPLE MULTIPLY PURPOSE
	MOV	17H,#00H
	MOV	18H,#00H
	MOV	19H,29H
	CALL	BIJIAO
	MOV	A,16H
	XRL	A,#00H 
	JZ	MZERO
	MOV	16H,26H
	MOV	17H,27H
	MOV	18H,28H
	MOV	19H,29H
	CALL	BIJIAO
	MOV	A,16H
	XRL	A,#00H  	
	JZ	LOOPM		; JUMP IF 1617 < 1819
	MOV	15H,#01H 
LOOPM:	MOV	5BH,#00H	; < COUNTER += 1
	MOV	5CH,#01H
	MOV	4BH,1BH
	MOV	4CH,1CH
	CALL	FUNADD		; TO HERE > 
	MOV	1CH,4CH		; < MOVE BACK TO COUNTER >
	MOV	1BH,4BH
	MOV	5BH,1DH		; < ADD NUMBER AT HERE
	MOV	5CH,1EH
	MOV	A,15H
	CJNE	A,#00H,M2ND
	MOV	4BH,26H
	MOV	4CH,27H
	JMP	MUL1
M2ND:	MOV	4BH,28H
	MOV	4CH,29H
MUL1:	CALL	FUNADD		; ADD FINISH >
	MOV	1EH,4CH		; < MOVE BACK TO NUMBER >
	MOV	1DH,4BH
	MOV	16H,1BH		; < BEGIN TO BIJIAO COUNTER
	MOV	17H,1CH
	MOV	A,15H
	CJNE	A,#00H,M2NDA
	MOV	18H,28H
	MOV	19H,29H
	JMP	MUL1A
M2NDA:	MOV	18H,26H
	MOV	19H,27H	
MUL1A:	CALL	BIJIAO		; TO HERE > 
	MOV	A,16H
	XRL	A,#00H 
	JZ	ENDMUL		; IF >= THEN JUMP TO FINISH THEM
	JNZ	LOOPM		; BUT < THEN CONTINUE
ENDMUL:	MOV	5BH,1DH		; < DAILY OUTPUT FROM HERE
	MOV	5CH,1EH		; TO HERE >
	ret			; < END > 
MZERO:	MOV	5BH,#00H
	MOV	5CH,#00H
	RET			; < END > 
BIJIAO:	MOV	A,16H
	XRL	A,18H
	JNZ	BIJI2
	MOV	A,17H
	SUBB	A,19H
	MOV	17H,#00H
	MOV	A,#00H
	ADDC	A,#00H
	XRL	A,#01H
	JZ	BIGAR
	MOV	16H,#00H
	RET
BIJI2:	MOV	A,16H
	SUBB	A,18H
 	MOV	16H,#00H
	MOV	A,#00H
	ADDC	A,#00H
	XRL	A,#01H
	JZ	BIGAR
	MOV	16H,#00H
	RET
BIGAR:	MOV	16H,#01H
	RET
FUNSUB:	MOV	46H,#00H
	MOV	47H,#00H
	MOV	48H,#00H
	MOV	49H,#00H
	MOV	A,4BH
	MOV	B,#10H
	DIV	AB
	MOV	40H,a
	MOV	41H,B
	MOV	A,4CH
	MOV	B,#10H
	DIV	AB
	MOV	42H,A
	MOV	43H,B
	MOV	A,5CH
	MOV	B,#10H
	DIV	AB
	MOV	50H,B
	MOV	51H,A
	MOV	A,5BH
	MOV	B,#10H
	DIV	AB
	MOV	52H,B
	MOV	53H,A
	MOV	4AH,#00H
LOOPS:	MOV	A,4AH
	CJNE	A,#00H,SNXTA1
	MOV	47H,43H
	MOV	49H,50H
	JMP	SNXTC
SNXTA1:	CJNE	A,#01H,SNXTA2
	MOV	47H,42H
	MOV	49H,51H
	JMP	SNXTC
SNXTA2:	CJNE	A,#02H,SNXTA3
	MOV	47H,41H
	MOV	49H,52H
	JMP	SNXTC
SNXTA3:	MOV	47H,40H
	MOV	49H,53H
SNXTC:	INC	4AH
	MOV	16H,46H
	MOV	17H,47H
	MOV	18H,48H
	MOV	19H,49H
	CALL	BIJIAO
	MOV	A,4AH
	XRL	A,#05H
	JZ	SNXTB4
	MOV	A,16H
	XRL	A,#01H
	JNZ	LOOPS
	MOV	A,4AH
	CJNE	A,#01H,SNXTB1
	MOV	A,43H
	ADD	A,#0AH
	MOV	43H,A
	MOV	A,51H
	ADD	A,#01H
	MOV	51H,A
	JMP	LOOPS
SNXTB1:	CJNE	A,#02H,SNXTB2
	MOV	A,42H
	ADD	A,#0AH
	MOV	42H,A
	MOV	A,52H
	ADD	A,#01H
	MOV	52H,A
	JMP	LOOPS
SNXTB2:	CJNE	A,#03H,SNXTB3
	MOV	A,41H
	ADD	A,#0AH
	MOV	41H,A
	MOV	A,53H
	ADD	A,#01H
	MOV	53H,A
	JMP	LOOPS
SNXTB3:	MOV	A,40H
	ADD	A,#0AH
	MOV	40H,A
	JMP	LOOPS
SNXTB4:	MOV	A,43H
	SUBB	A,50H
	MOV	50H,A
	MOV	A,42H
	SUBB	A,51H
	MOV	51H,A
	SWAP	A
	ADD	A,50H
	MOV	4CH,A
	MOV	A,41H
	SUBB	A,52H
	MOV	52H,A
	MOV	A,40H
	SUBB	A,53H
	MOV	53H,A
	SWAP	A
	ADD	A,52H
	MOV	4BH,A
	RET
FUNADD:	MOV	48H,#00H
	MOV	49H,#0AH
	MOV	4DH,#00H
	MOV	4EH,#00H
	MOV	A,4BH
	MOV	B,#10H
	DIV	AB
	MOV	40H,a
	MOV	41H,B
	MOV	A,4CH
	MOV	B,#10H
	DIV	AB
	MOV	42H,A
	MOV	43H,B
	MOV	A,5CH
	MOV	B,#10H
	DIV	AB
	MOV	50H,B
	MOV	51H,A
	MOV	A,5BH
	MOV	B,#10H
	DIV	AB
	MOV	52H,B
	MOV	53H,A
	MOV	4AH,#00H
LOOPA:	MOV	A,4AH
	CJNE	A,#00H,ANXTA1
	MOV	A,43H
	ADD	A,50H
	JMP	ANXTC
ANXTA1:	CJNE	A,#01H,ANXTA2
	MOV	A,42H
	ADD	A,51H
	JMP	ANXTC
ANXTA2:	CJNE	A,#02H,ANXTA3
	MOV	A,41H
	ADD	A,52H
	JMP	ANXTC
ANXTA3:	MOV	A,40H
	ADD	A,53H
ANXTC:	MOV	46H,#00H
	MOV	47H,A
	INC	4AH
	MOV	16H,46H
	MOV	17H,47H
	MOV	18H,48H
	MOV	19H,49H
	CALL	BIJIAO
	MOV	A,4AH
	XRL	A,#05H
	JZ	ANXTB4
	MOV	A,16H
	XRL	A,#00H
	JNZ	LOOPA
	MOV	A,4AH
	CJNE	A,#01H,ANXTB1
	MOV	4EH,#06H
	MOV	A,51H
	ADD	A,#01H
	MOV	51H,A
	JMP	LOOPA
ANXTB1:	CJNE	A,#02H,ANXTB2
	MOV	A,4EH
	ADD	A,#60H
	MOV	4EH,A
	MOV	4DH,#01H
	MOV	A,52H
	ADD	A,#01H
	MOV	52H,A
	JMP	LOOPA
ANXTB2:	CJNE	A,#03H,ANXTB3
	MOV	A,4DH
	ADD	A,#06H
	MOV	4DH,A
	MOV	A,53H
	ADD	A,#01H
	MOV	53H,A
	JMP	LOOPA
ANXTB3:	MOV	A,4DH
	ADD	A,#60H
	MOV	4DH,A
	JMP	LOOPA
ANXTB4:	MOV	A,4CH
	ADD	A,5CH
	ADD	A,4EH
	MOV	4CH,A
	MOV	B,#10H
	DIV	AB
	MOV	51H,A
	MOV	50H,B
	MOV	A,4BH
	ADD	A,5BH
	ADD	A,4DH
	MOV	4BH,A
	MOV	B,#10H
	DIV	AB
	MOV	53H,A
	MOV	52H,B
	RET
	ORG	650H
TABLE:	DB	07H,08H,09H,0AH
	DB	04H,05H,06H,0BH
	DB	01H,02H,03H,0EH
	DB	0CH,00H,0DH,0FH
NOMBOR:	DB	40H,79H,24H,30H
	DB	19H,12H,02H,78H
	DB	00H,10H,08H,03H
	DB	27H,21H,06H,0EH
	END

LOG FOR USED REGISTER
00 - 07 
10 - 11 / 12 - 13 / 14 / 16 - 19 / 1A - 1E
20 / 21 - 23 / 24
30 - 35